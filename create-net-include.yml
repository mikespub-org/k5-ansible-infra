---
#
# This file is an include to loop with_items over two tasks 
#  to create the network and subnet
# note the "outer_item" to pull in the with_items from the calling playbook
#

        - name: "Create Network"
          # https://docs.ansible.com/ansible/os_network_module.html
          os_network:
            state: present
            name: "{{ outer_item.name }}"
            external: "{{ outer_item.external }}"
            region_name: "{{ region.name }}"
            availability_zone: "{{ region.az }}"

        - name: "Create Subnet"
          # https://docs.ansible.com/ansible/os_subnet_module.html
          os_subnet:
            state: present
            network_name: "{{ outer_item.name }}"
            name: "{{ outer_item.subnet }}"
            cidr: "{{ outer_item.cidr }}"


